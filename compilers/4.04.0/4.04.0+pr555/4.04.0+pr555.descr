Ensure that register typing constraints are respected at join points