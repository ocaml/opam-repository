opam-version: "2.0"

authors: ["rajdakin"]
maintainer: "engineering@wasmer.io"
license: "MIT"
homepage: "https://github.com/wasmerio/wasmer-ocaml"
doc: "https://github.com/wasmerio/wasmer-ocaml"
bug-reports: "https://github.com/wasmerio/wasmer-ocaml/issues"
dev-repo: "git+https://github.com/wasmerio/wasmer-ocaml.git"
tags: ["org:wasmer"]
url {
	src: "https://github.com/wasmerio/wasmer-ocaml/archive/refs/tags/1.0.0.zip"
	checksum: [] # Placeholder, TODO
}

synopsis: "The official Wasmer bindings for OCaml"

depends: ["ocaml" {>= "4.14.1"} "ocamlfind" "ctypes" "ctypes-foreign" "libwasmer"]
build: [[make "all"]]
run-test: [[make "check"]]
build-env: [
	[ECHO = "true"]
]
setenv: [ # Hacky, but should work; prioritizes the opam library over the system one
	[LIBRARY_PATH := "%{libwasmer:lib}%"]
	[LD_LIBRARY_PATH := "%{libwasmer:lib}%"]
	[DYLD_LIBRARY_PATH := "%{libwasmer:lib}%"]
]
install: [make "install"]
